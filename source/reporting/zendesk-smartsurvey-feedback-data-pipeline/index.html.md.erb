---
title: Feedback data processing pipeline
weight: 41
last_reviewed_on: 2022-02-14
review_in: 6 months
---

# Feedback data processing pipeline

GOV.UK users can provide feedback about GOV.UK by selecting the:

- "Is this page useful? Yes / No" button on a GOV.UK page to provide qualitative feedback about their experience on GOV.UK
- "Report a problem" button on a GOV.UK page to report issues with that page
- "Contact" link in a GOV.UK page footer to go to a service-specific contact page to leave written feedback

These feedback methods appear on all GOV.UK pages.

The GOV.UK Insights team is required to collate feedback data from multiple sources to make that data available to GDS users for analysis.

The [GOV.UK Feedback Pipeline tool](https://github.com/alphagov/govuk-feedback-pipeline) consolidates, cleanses and standardises the feedback data to enable accurate analysis of the user feedback. This maximises the quality and reliability of the user feedback data, making it easier to identify both known and new meaningful insights and actions.

The following content explains how:

- GDS copies the feedback data from multiple data sources
- the Feedback Pipeline tool cleanses the feedback data
- the tool saves the feedback data in BigQuery

## Copy the feedback data

Feedback data is stored in one of the following data sources, depending on the route through which the feedback was submitted:

- the "Is this page useful?" survey results are stored in SmartSurvey
- both the "Report a problem" issue descriptions and "Contact" request details are stored in Zendesk

Every day at approximately 8:10am, an [Apache Airflow process](https://airflow.apache.org/) runs a collection of Python scripts to copy the previous day's feedback data from the SmartSurvey and Zendesk servers to BigQuery.

These Python scripts are located in the [govuk-user-journey-models GitHub repo on alphagov](https://github.com/alphagov/govuk-user-journey-models).

To get access to this repo, speak to the GDS Data Labs team on the [#govuk-data-labs Slack channel](https://app.slack.com/client/T8GT9416G/CHR4UQKU4).

## Cleanse the feedback data

A feedback submission by a single user of GOV.UK is a feedback record.

The Feedback Pipeline tool cleanses the feedback records in the SmartSurvey and Zendesk data sets in BigQuery.

### Data cleansing methods

The tool uses 4 data cleansing methods:

- pruning
- masking
- filtering
- marking up

The tool identifies data to cleanse using known text patterns, otherwise known as regular expressions.

See the [Feedback Pipeline tool regular expressions documentation](/reporting/zendesk-smartsurvey-feedback-data-pipeline/regex/) for more information.

#### Pruning

Pruning is removing a portion of nonsensical or irrelevant feedback text from a feedback record.

Examples of pruning include trimming whitespace and removing URL parameters or code snippets.

#### Masking

Masking is replacing a portion of feedback text with a text mask indicating that the feedback text has been modified.

An example of a text mask is `****`. Text can be masked because the portion is:

- not relevant to the analysis
- potentially sensitive
- personally identifiable information (PII) or profanity

#### Filtering

Filtering is excluding a feedback record from the pipeline output data set because the feedback record has no relevant or legitimate feedback.

Examples of feedback records that should be filtered are spam records or duplicate records.

#### Marking up

Marking up is adding a flag to a feedback record to suggest that the record may be spam or has no relevant or legitimate feedback.

This way, the record remains in the data set, but can be filtered out later

### Data cleansing

The Feedback Pipeline tool goes through the following steps to cleanse the SmartSurvey and Zendesk data sets.

1. Reads the feedback data from the previous full day from the data sets by submitting an API request.

1. Prunes unnnecessary white space in feedback text to avoid issues in text analysis later in the process.

1. Deletes duplicate feedback records to minimise processing cost. Duplicate records share an internal system identifier with another record in the same data set.

1. Deletes verbose feedback records as verbose records cannot be processed and analysed later in the process. Verbose records are defined as having more than 2000 characters.

1. Deletes records whose text patterns match known vulnerability exploits, such as javascript or SQL strings, or contain text patterns indicating the use of vulnerability scanning tools.

1. Masks and removes PII in a 2 step process. First, the tool sends the data to the [Google Cloud Data Loss Prevention service (DLP)](https://cloud.google.com/dlp). Google Cloud DLP looks for the following information types:

    ```
    Date of birth
    Email address
    Passport number
    Person name
    Phone number
    Street address
    UK National Insurance number
    ```
    Google Cloud DLP then cleanses the data of these information types and returns the cleansed data to the tool.

    Second, the tool compares the feedback records against PII regular expressions. The tool then masks any identified PII instances.

1. Prunes code snippets in feedback records by replacing those snippets with the blank character '', as code snippets are not relevant to feedback data analysis.

1. Masks instances of profanity in feedback records with `****`.

The tool has finished cleansing the feedback data.

## Save the feedback data in BigQuery

The Feedback Pipeline tool saves the following to BigQuery:

- cleansed data
- pipeline metrics
- PII metrics

### Save the cleansed data

When the data cleansing is complete, the tool saves the data into the GOV.UK Analytics project in BigQuery, `govuk-bigquery-analytics`.

Within this project:

- the Zendesk data is stored in the `zendeskdata` data set
- the SmartSurvey data is stored in the `UISData` data set

Within these data sets are the daily data tables. Each dayâ€™s data is created as a new data table with a `YYYYMMDD` format. For example, for 9 March 2021:

- the SmartSurvey data table is `UISData_20210309`
- the Zendesk data table is `zendesk_20210309`

To request permission to view or edit these data tables in BigQuery, speak to the GDS Data Labs team on the [#govuk-data-labs Slack channel](https://app.slack.com/client/T8GT9416G/CHR4UQKU4).

The Zendesk and SmartSurvey feedback data is now in BigQuery, ready for users to view and analyse.

See the [documentation on viewing or extracting feedback data from BigQuery](/reporting/view-extract-feedback-data-bigquery/) for more information on the next step of the process.

### Save the pipeline and PII metrics

The tool also saves pipeline and PII metrics to BigQuery.

The pipeline metrics summarise the changes to the feedback records due to the data cleansing process.

The PII metrics show how many articles of PII have been removed for each combination of PII type and source system field.

In the following example, the metrics table shows that the feedback pipeline tool has removed 10 instances of person names from the description field in the data source.

```
Source system field: description
PII type: Person Name
Number removed: 10
```

## Data field definitions

All data fields in BigQuery are text strings.

For more information on the BigQuery data field definitions, see the [Google Analytics BigQuery Export schema documentation](https://support.google.com/analytics/answer/3437719).
